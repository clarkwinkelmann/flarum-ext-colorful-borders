(()=>{var t={n:o=>{var r=o&&o.__esModule?()=>o.default:()=>o;return t.d(r,{a:r}),r},d:(o,r)=>{for(var e in r)t.o(r,e)&&!t.o(o,e)&&Object.defineProperty(o,e,{enumerable:!0,get:r[e]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o);const r=flarum.core.compat["forum/app"];var e=t.n(r);const n=flarum.core.compat["common/extend"],l=flarum.core.compat["common/Model"];var a=t.n(l);const s=flarum.core.compat["common/Store"];var u=t.n(s);function i(t,o){t&&t.attributes&&t.attributes.hasOwnProperty("colorfulBordersStyle")&&!t.attributes.hasOwnProperty("savedColorfulBordersStyle")&&(o.data.attributes.savedColorfulBordersStyle=JSON.parse(JSON.stringify(t.attributes.colorfulBordersStyle)))}const c=flarum.core.compat["forum/components/CommentPost"];var d=t.n(c);function f(t,o){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},f(t,o)}const p=flarum.core.compat["common/Component"];var y=t.n(p);const b=flarum.core.compat["common/components/Button"];var h=t.n(b);const g=flarum.core.compat["common/helpers/icon"];var S=t.n(g),v="clarkwinkelmann-colorful-borders.forum.",B=function(t){var o,r;function n(){for(var o,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return(o=t.call.apply(t,[this].concat(e))||this).loading=!1,o}r=t,(o=n).prototype=Object.create(r.prototype),o.prototype.constructor=o,f(o,r);var l=n.prototype;return l.option=function(t,o,r){var n=this;return[m(".ColorfulBorders-Title",e().translator.trans(v+t)),m(".ColorfulBorders-Option",[m("label",[m("input",{type:"radio",checked:null===this.getStyle(o),onchange:function(){n.setStyle(o,null)}})," ",e().translator.trans(v+"default")]),r])]},l.colorOption=function(t,o){var r=this,n=e().forum.attribute("colorful-borders."+t+"s");return this.option(t,o,Array.isArray(n)?m(".ColorfulBorders-Option-Control",n.map((function(t){return m(".ColorfulBorders-ColorChoice",{style:{backgroundColor:t},onclick:function(){r.setStyle(o,t)},className:r.getStyle(o)===t?"selected":""})}))):m("input.ColorfulBorders-Option-Control",{type:"color",value:this.getStyle(o),onchange:function(t){r.setStyle(o,t.target.value)}}))},l.rangeOption=function(t){var o=this,r=e().forum.attribute("colorful-borders."+t+"Min"),n=e().forum.attribute("colorful-borders."+t+"Max");return r===n?this.option(t,t,m("label.ColorfulBorders-Option-Control",[m("input",{type:"radio",checked:this.getStyle(t)===r+"px",onchange:function(){o.setStyle(t,r+"px")}})," "+r+"px"])):this.option(t,t,m("input.ColorfulBorders-Option-Control",{type:"range",min:r,max:n,value:parseInt(this.getStyle(t)||"0"),oninput:function(r){o.setStyle(t,r.target.value+"px")}}))},l.view=function(){var t=this;return m(".Dropdown.ColorfulBorders",[m("a.Dropdown-toggle",{"data-toggle":"dropdown"},[S()("fas fa-palette")," ",e().translator.trans(v+"edit")]),m(".Dropdown-menu",{onclick:function(t){t.stopPropagation(),t.redraw=!1}},[e().forum.attribute("colorful-borders.enableBorderColor")?this.colorOption("borderColor","borderColor"):null,e().forum.attribute("colorful-borders.enableBackgroundColor")?this.colorOption("backgroundColor","backgroundColor"):null,e().forum.attribute("colorful-borders.enableTextColor")?this.colorOption("textColor","color"):null,e().forum.attribute("colorful-borders.enableBorderWidth")?this.rangeOption("borderWidth"):null,e().forum.attribute("colorful-borders.enableBorderRadius")?this.rangeOption("borderRadius"):null,h().component({className:"Button Button--primary Button--block",disabled:!this.isDirty(),loading:this.loading,onclick:function(){t.loading=!0,t.attrs.resource.save({colorfulBordersStyle:t.attrs.resource.attribute("colorfulBordersStyle")}).then((function(){t.loading=!1,m.redraw(),t.$(".Dropdown-toggle").dropdown("toggle")})).catch((function(o){throw t.loading=!1,o}))}},e().translator.trans(v+"apply")),h().component({className:"Button Button--block",disabled:null===this.attrs.resource.attribute("savedColorfulBordersStyle"),loading:this.loading,onclick:function(){t.loading=!0,t.attrs.resource.save({colorfulBordersStyle:null}).then((function(){t.loading=!1,m.redraw(),t.$(".Dropdown-toggle").dropdown("toggle")})).catch((function(o){throw t.loading=!1,o}))}},e().translator.trans(v+"reset"))])])},l.isDirty=function(){return JSON.stringify(this.attrs.resource.data.attributes.colorfulBordersStyle)!==JSON.stringify(this.attrs.resource.data.attributes.savedColorfulBordersStyle)},l.oncreate=function(o){var r=this;t.prototype.oncreate.call(this,o),this.$().on("hide.bs.dropdown",(function(){r.isDirty()&&(r.attrs.resource.data.attributes.colorfulBordersStyle=r.attrs.resource.data.attributes.savedColorfulBordersStyle,m.redraw())}))},l.getStyle=function(t){var o=this.attrs.resource.attribute("colorfulBordersStyle");return o&&o.hasOwnProperty(t)?o[t]:null},l.setStyle=function(t,o){var r=this.attrs.resource.attribute("colorfulBordersStyle");r||(r={}),null===o?delete r[t]:r[t]=o,this.attrs.resource.data.attributes.colorfulBordersStyle=r},n}(y());e().initializers.add("clarkwinkelmann-colorful-borders",(function(){(0,n.extend)(u().prototype,"createRecord",(function(t,o,r){i(r,t)})),(0,n.extend)(a().prototype,"pushData",(function(t,o){i(o,this)})),(0,n.extend)(d().prototype,"headerItems",(function(t){this.attrs.post.attribute("canEditColorfulBordersStyle")&&t.add("colorful-borders",B.component({resource:this.attrs.post}))})),(0,n.extend)(d().prototype,"oninit",(function(){var t=this;this.subtree.check((function(){return JSON.stringify(t.attrs.post.attribute("colorfulBordersStyle"))}))})),(0,n.extend)(d().prototype,"elementAttrs",(function(t){var o=this.attrs.post.attribute("colorfulBordersStyle");o&&(t.style||(t.style={}),Object.keys(o).forEach((function(r){t.style[r]=o[r]})))}))}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map